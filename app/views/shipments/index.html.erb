<% provide(:title, "Invoices") %>

<h1>Invoices</h1>
<% if policy(Shipment).new? %>
  <p><%= link_to 'Add New Invoice', new_shipment_path, class: "button" %></p>
<% end %>

<%= render partial: 'search_form', object: @search_form %>

<% if @shipments.any? %>
  <ul class="stack-for-small secondary button-group">
    <li>
      <%= link_to invoices_shipments_path(search: params[:search]), target: '_blank', class: "button" do %>
        <i class="fi-page-export-pdf"></i> Print Invoices
      <% end %>
    </li>
    <li>
      <%= link_to invoices_csv_shipments_path(search: params[:search]), class: "button" do %>
        <i class="fi-page-export-csv"></i> Export CSV
      <% end %>
    </li>
    <li>
      <%= link_to invoices_iif_shipments_path(search: params[:search]), class: "button" do %>
        <i class="fi-page-export"></i> Export QuickBooks
      <% end %>
    </li>
  </ul>
<% end %>

<table class="responsive-table">
  <thead>
    <tr>
      <th scope="col">Invoice</th>
      <th scope="col">Date</th>
      <th scope="col">Client</th>
      <th scope="col">Price</th>
      <th scope="col">Action</th>
    </tr>
  </thead>
  <tbody>
    <% shipments.each do |shipment| %>
      <tr class="js-clickable-row" href="<%= edit_shipment_path(shipment) %>">
        <th scope="row"><%= shipment.invoice_number %></th>
        <td data-title="Date"><%= shipment.date %></td>
        <td data-title="Client Name"><%= shipment.client_name %></td>
        <td data-title="Price"><%= shipment.price %></td>
        <td data-title="Action">
          <%= link_to edit_shipment_path(shipment) do %>
            <span class="table-action-icon icon-link-tooltip" aria-label="Edit Invoice">
              <i class="fi-page-edit"></i>
            </span>
          <% end %>
          <%= link_to invoice_shipment_path(shipment, format: :pdf), target: "_blank" do %>
            <span class="table-action-icon icon-link-tooltip" aria-label="Invoice">
              <i class="fi-page-export-pdf"></i>
            </span>
          <% end %>
          <%= link_to packing_slip_shipment_path(shipment, format: :pdf), target: "_blank" do %>
            <span class="table-action-icon icon-link-tooltip" aria-label="Packing Slip">
              <i class="fi-page-export"></i>
            </span>
          <% end %>
          <%= link_to invoice_iif_shipment_path(shipment), target: "_blank" do %>
            <span class="table-action-icon icon-link-tooltip" aria-label="Quickbooks IIF">
              <i class="fi-page-export"></i>
            </span>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= will_paginate @shipments %>
